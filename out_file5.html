<html lang="en">
        <head>
          <meta charset="UTF-8">
          <meta http-equiv="X-UA-Compatible" content="IE=edge">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <link rel="stylesheet" href="./style.css">
          <title>Syntax Highlighter</title>
        </head>
        <body>
          <pre>
            <code>
              <span class="keyword">from</span> <span class="identifier">collections</span> <span class="keyword">import</span> <span class="identifier">Counter</span>

<span class="keyword">import</span> <span class="identifier">numpy</span> <span class="keyword">as</span> <span class="identifier">np</span>
<span class="keyword">from</span> <span class="identifier">sklearn</span> <span class="keyword">import</span> <span class="identifier">datasets</span>
<span class="keyword">from</span> <span class="identifier">sklearn</span><span class="delimiter">.</span><span class="identifier">model_selection</span> <span class="keyword">import</span> <span class="identifier">train_test_split</span>

<span class="identifier">data</span> <span class="delimiter">=</span> <span class="identifier">datasets</span><span class="delimiter">.</span><span class="identifier">load_iris</span><span class="delimiter">(</span><span class="delimiter">)</span>

<span class="identifier">X</span> <span class="delimiter">=</span> <span class="identifier">np</span><span class="delimiter">.</span><span class="identifier">array</span><span class="delimiter">(</span><span class="identifier">data</span><span class="delimiter">[</span><span class="string">"data"</span><span class="delimiter">]</span><span class="delimiter">)</span>
<span class="identifier">y</span> <span class="delimiter">=</span> <span class="identifier">np</span><span class="delimiter">.</span><span class="identifier">array</span><span class="delimiter">(</span><span class="identifier">data</span><span class="delimiter">[</span><span class="string">"target"</span><span class="delimiter">]</span><span class="delimiter">)</span>
<span class="identifier">classes</span> <span class="delimiter">=</span> <span class="identifier">data</span><span class="delimiter">[</span><span class="string">"target_names"</span><span class="delimiter">]</span>

<span class="identifier">X_train</span><span class="delimiter">,</span> <span class="identifier">X_test</span><span class="delimiter">,</span> <span class="identifier">y_train</span><span class="delimiter">,</span> <span class="identifier">y_test</span> <span class="delimiter">=</span> <span class="identifier">train_test_split</span><span class="delimiter">(</span><span class="identifier">X</span><span class="delimiter">,</span> <span class="identifier">y</span><span class="delimiter">)</span>


<span class="keyword">def</span> <span class="identifier">euclidean_distance</span><span class="delimiter">(</span><span class="identifier">a</span><span class="delimiter">,</span> <span class="identifier">b</span><span class="delimiter">)</span><span class="delimiter">:</span>
    <span class="keyword">return</span> <span class="identifier">np</span><span class="delimiter">.</span><span class="identifier">linalg</span><span class="delimiter">.</span><span class="identifier">norm</span><span class="delimiter">(</span><span class="identifier">np</span><span class="delimiter">.</span><span class="identifier">array</span><span class="delimiter">(</span><span class="identifier">a</span><span class="delimiter">)</span> <span class="operator">-</span> <span class="identifier">np</span><span class="delimiter">.</span><span class="identifier">array</span><span class="delimiter">(</span><span class="identifier">b</span><span class="delimiter">)</span>


<span class="keyword">def</span> <span class="identifier">classifier</span><span class="delimiter">(</span><span class="identifier">train_data</span><span class="delimiter">,</span> <span class="identifier">train_target</span><span class="delimiter">,</span> <span class="identifier">classes</span><span class="delimiter">,</span> <span class="identifier">point</span><span class="delimiter">,</span> <span class="identifier">k</span><span class="delimiter">=</span><span class="number">5</span><span class="delimiter">)</span><span class="delimiter">:</span>
    <span class="identifier">data</span> <span class="delimiter">=</span> <span class="built_in_function">zip</span><span class="delimiter">(</span><span class="identifier">train_data</span><span class="delimiter">,</span> <span class="identifier">train_target</span><span class="delimiter">)</span>
    <span class="comment"># List of distances of all points from the point to be classified</span>
    <span class="identifier">distances</span> <span class="delimiter">=</span> <span class="delimiter">[</span><span class="delimiter">]</span>
    <span class="keyword">for</span> <span class="identifier">data_point</span> <span class="keyword">in</span> <span class="identifier">data</span><span class="delimiter">:</span>
        <span class="identifier">distance</span> <span class="delimiter">=</span> <span class="identifier">euclidean_distance</span><span class="delimiter">(</span><span class="identifier">data_point</span><span class="delimiter">[</span><span class="number">0</span><span class="delimiter">]</span><span class="delimiter">,</span> <span class="identifier">point</span><span class="delimiter">)</span>
        <span class="identifier">distances</span><span class="delimiter">.</span><span class="built_in_function">append</span><span class="delimiter">(</span><span class="identifier">distance</span><span class="delimiter">,</span> <span class="identifier">data_point</span><span class="delimiter">[</span><span class="number">1</span><span class="delimiter">]</span><span class="delimiter">)</span>
    <span class="comment"># Choosing 'k' points with the least distances.</span>
    <span class="identifier">votes</span> <span class="delimiter">=</span> <span class="delimiter">[</span><span class="identifier">i</span><span class="delimiter">[</span><span class="number">1</span><span class="delimiter">]</span> <span class="keyword">for</span> <span class="identifier">i</span> <span class="keyword">in</span> <span class="built_in_function">sorted</span><span class="delimiter">(</span><span class="identifier">distances</span><span class="delimiter">)</span><span class="delimiter">[</span><span class="delimiter">:</span><span class="identifier">k</span><span class="delimiter">]</span>
    <span class="comment"># Most commonly occurring class among them</span>
    <span class="comment"># is the class into which the point is classified</span>
    <span class="identifier">result</span> <span class="delimiter">=</span> <span class="identifier">Counter</span><span class="delimiter">(</span><span class="identifier">votes</span><span class="delimiter">)</span><span class="delimiter">.</span><span class="identifier">most_common</span><span class="delimiter">(</span><span class="number">1</span><span class="delimiter">)</span><span class="delimiter">[</span><span class="number">0</span><span class="delimiter">]</span><span class="delimiter">[</span><span class="number">0</span><span class="delimiter">]</span>
    <span class="keyword">return</span> <span class="identifier">classes</span><span class="delimiter">[</span><span class="identifier">result</span><span class="delimiter">]</span>


<span class="keyword">if</span> <span class="identifier">__name__</span> <span class="delimiter">=</span> <span class="string">"__main__"</span><span class="delimiter">:</span>
    <span class="keyword">print</span><span class="delimiter">(</span><span class="identifier">classifier</span><span class="delimiter">(</span><span class="identifier">X_train</span><span class="delimiter">,</span> <span class="identifier">y_train</span><span class="delimiter">,</span> <span class="identifier">classes</span><span class="delimiter">,</span> <span class="delimiter">[</span><span class="number">4.4</span><span class="delimiter">,</span> <span class="number">3.1</span><span class="delimiter">,</span> <span class="number">1.3</span><span class="delimiter">,</span> <span class="number">1.4</span><span class="delimiter">]</span><span class="delimiter">)</span>
    

<span class="comment"># Make a training dataset drawn from a gaussian distribution</span>
<span class="keyword">def</span> <span class="identifier">gaussian_distribution</span><span class="delimiter">(</span><span class="identifier">mean</span><span class="delimiter">:</span> <span class="built_in_function">float</span><span class="delimiter">,</span> <span class="identifier">std_dev</span><span class="delimiter">:</span> <span class="built_in_function">float</span><span class="delimiter">,</span> <span class="identifier">instance_count</span><span class="delimiter">:</span> <span class="built_in_function">int</span><span class="delimiter">)</span> <span class="operator">-</span><span class="operator">></span> <span class="built_in_function">list</span><span class="delimiter">:</span>

    <span class="identifier">seed</span><span class="delimiter">(</span><span class="number">1</span><span class="delimiter">)</span>
    <span class="keyword">return</span> <span class="delimiter">[</span><span class="identifier">gauss</span><span class="delimiter">(</span><span class="identifier">mean</span><span class="delimiter">,</span> <span class="identifier">std_dev</span><span class="delimiter">)</span> <span class="keyword">for</span> <span class="identifier">_</span> <span class="keyword">in</span> <span class="built_in_function">range</span><span class="delimiter">(</span><span class="identifier">instance_count</span><span class="delimiter">)</span><span class="delimiter">]</span>


<span class="comment"># Make corresponding Y flags to detecting classes</span>
<span class="keyword">def</span> <span class="identifier">y_generator</span><span class="delimiter">(</span><span class="identifier">class_count</span><span class="delimiter">:</span> <span class="built_in_function">int</span><span class="delimiter">,</span> <span class="identifier">instance_count</span><span class="delimiter">:</span> <span class="built_in_function">list</span><span class="delimiter">)</span> <span class="operator">-</span><span class="operator">></span> <span class="built_in_function">list</span><span class="delimiter">:</span>

    <span class="keyword">return</span> <span class="delimiter">[</span><span class="identifier">k</span> <span class="keyword">for</span> <span class="identifier">k</span> <span class="keyword">in</span> <span class="built_in_function">range</span><span class="delimiter">(</span><span class="identifier">class_count</span><span class="delimiter">)</span> <span class="keyword">for</span> <span class="identifier">_</span> <span class="keyword">in</span> <span class="built_in_function">range</span><span class="delimiter">(</span><span class="identifier">instance_count</span><span class="delimiter">[</span><span class="identifier">k</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">]</span>


<span class="comment"># Calculate the class means</span>
<span class="keyword">def</span> <span class="identifier">calculate_mean</span><span class="delimiter">(</span><span class="identifier">instance_count</span><span class="delimiter">:</span> <span class="built_in_function">int</span><span class="delimiter">,</span> <span class="identifier">items</span><span class="delimiter">:</span> <span class="built_in_function">list</span><span class="delimiter">)</span> <span class="operator">-</span><span class="operator">></span> <span class="built_in_function">float</span><span class="delimiter">:</span>
  
    <span class="comment"># the sum of all items divided by number of instances</span>
    <span class="keyword">return</span> <span class="built_in_function">sum</span><span class="delimiter">(</span><span class="identifier">items</span><span class="delimiter">)</span> <span class="operator">/</span> <span class="identifier">instance_count</span>


<span class="comment"># Calculate the class probabilities</span>
<span class="keyword">def</span> <span class="identifier">calculate_probabilities</span><span class="delimiter">(</span><span class="identifier">instance_count</span><span class="delimiter">:</span> <span class="built_in_function">int</span><span class="delimiter">,</span> <span class="identifier">total_count</span><span class="delimiter">:</span> <span class="built_in_function">int</span><span class="delimiter">)</span> <span class="operator">-</span><span class="operator">></span> <span class="built_in_function">float</span><span class="delimiter">:</span>
  
    <span class="comment"># number of instances in specific class divided by number of all instances</span>
    <span class="keyword">return</span> <span class="identifier">instance_count</span> <span class="operator">/</span> <span class="identifier">total_count</span>


<span class="comment"># Calculate the variance</span>
<span class="keyword">def</span> <span class="identifier">calculate_variance</span><span class="delimiter">(</span><span class="identifier">items</span><span class="delimiter">:</span> <span class="built_in_function">list</span><span class="delimiter">,</span> <span class="identifier">means</span><span class="delimiter">:</span> <span class="built_in_function">list</span><span class="delimiter">,</span> <span class="identifier">total_count</span><span class="delimiter">:</span> <span class="built_in_function">int</span><span class="delimiter">)</span> <span class="operator">-</span><span class="operator">></span> <span class="built_in_function">float</span><span class="delimiter">:</span>
  
    <span class="identifier">squared_diff</span> <span class="delimiter">=</span> <span class="delimiter">[</span><span class="delimiter">]</span>  <span class="comment"># An empty list to store all squared differences</span>
    <span class="comment"># iterate over number of elements in items</span>
    <span class="keyword">for</span> <span class="identifier">i</span> <span class="keyword">in</span> <span class="built_in_function">range</span><span class="delimiter">(</span><span class="built_in_function">len</span><span class="delimiter">(</span><span class="identifier">items</span><span class="delimiter">)</span><span class="delimiter">:</span>
        <span class="comment"># for loop iterates over number of elements in inner layer of items</span>
        <span class="keyword">for</span> <span class="identifier">j</span> <span class="keyword">in</span> <span class="built_in_function">range</span><span class="delimiter">(</span><span class="built_in_function">len</span><span class="delimiter">(</span><span class="identifier">items</span><span class="delimiter">[</span><span class="identifier">i</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">:</span>
            <span class="comment"># appending squared differences to 'squared_diff' list</span>
            <span class="identifier">squared_diff</span><span class="delimiter">.</span><span class="built_in_function">append</span><span class="delimiter">(</span><span class="identifier">items</span><span class="delimiter">[</span><span class="identifier">i</span><span class="delimiter">]</span><span class="delimiter">[</span><span class="identifier">j</span><span class="delimiter">]</span> <span class="operator">-</span> <span class="identifier">means</span><span class="delimiter">[</span><span class="identifier">i</span><span class="delimiter">]</span><span class="delimiter">)</span> <span class="operator">**</span> <span class="number">2</span><span class="delimiter">)</span>

    <span class="comment"># one divided by (the number of all instances - number of classes) multiplied by</span>
    <span class="comment"># sum of all squared differences</span>
    <span class="identifier">n_classes</span> <span class="delimiter">=</span> <span class="built_in_function">len</span><span class="delimiter">(</span><span class="identifier">means</span><span class="delimiter">)</span>  <span class="comment"># Number of classes in dataset</span>
    <span class="keyword">return</span> <span class="number">1</span> <span class="operator">/</span> <span class="delimiter">(</span><span class="identifier">total_count</span> <span class="operator">-</span> <span class="identifier">n_classes</span><span class="delimiter">)</span> <span class="operator">*</span> <span class="built_in_function">sum</span><span class="delimiter">(</span><span class="identifier">squared_diff</span><span class="delimiter">)</span>


<span class="comment"># Making predictions</span>
<span class="keyword">def</span> <span class="identifier">predict_y_values</span><span class="delimiter">(</span>
    <span class="identifier">x_items</span><span class="delimiter">:</span> <span class="built_in_function">list</span><span class="delimiter">,</span> <span class="identifier">means</span><span class="delimiter">:</span> <span class="built_in_function">list</span><span class="delimiter">,</span> <span class="identifier">variance</span><span class="delimiter">:</span> <span class="built_in_function">float</span><span class="delimiter">,</span> <span class="identifier">probabilities</span><span class="delimiter">:</span> <span class="built_in_function">list</span>
<span class="delimiter">)</span> <span class="operator">-</span><span class="operator">></span> <span class="built_in_function">list</span><span class="delimiter">:</span>
     
    <span class="comment"># An empty list to store generated discriminant values of all items in dataset for</span>
    <span class="comment"># each class</span>
    <span class="identifier">results</span> <span class="delimiter">=</span> <span class="delimiter">[</span><span class="delimiter">]</span>
    <span class="comment"># for loop iterates over number of elements in list</span>
    <span class="keyword">for</span> <span class="identifier">i</span> <span class="keyword">in</span> <span class="built_in_function">range</span><span class="delimiter">(</span><span class="built_in_function">len</span><span class="delimiter">(</span><span class="identifier">x_items</span><span class="delimiter">)</span><span class="delimiter">:</span>
        <span class="comment"># for loop iterates over number of inner items of each element</span>
        <span class="keyword">for</span> <span class="identifier">j</span> <span class="keyword">in</span> <span class="built_in_function">range</span><span class="delimiter">(</span><span class="built_in_function">len</span><span class="delimiter">(</span><span class="identifier">x_items</span><span class="delimiter">[</span><span class="identifier">i</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">:</span>
            <span class="identifier">temp</span> <span class="delimiter">=</span> <span class="delimiter">[</span><span class="delimiter">]</span>  <span class="comment"># to store all discriminant values of each item as a list</span>
            <span class="comment"># for loop iterates over number of classes we have in our dataset</span>
            <span class="keyword">for</span> <span class="identifier">k</span> <span class="keyword">in</span> <span class="built_in_function">range</span><span class="delimiter">(</span><span class="built_in_function">len</span><span class="delimiter">(</span><span class="identifier">x_items</span><span class="delimiter">)</span><span class="delimiter">:</span>
                <span class="comment"># appending values of discriminants for each class to 'temp' list</span>
                <span class="identifier">temp</span><span class="delimiter">.</span><span class="built_in_function">append</span><span class="delimiter">(</span>
                    <span class="identifier">x_items</span><span class="delimiter">[</span><span class="identifier">i</span><span class="delimiter">]</span><span class="delimiter">[</span><span class="identifier">j</span><span class="delimiter">]</span> <span class="operator">*</span> <span class="delimiter">(</span><span class="identifier">means</span><span class="delimiter">[</span><span class="identifier">k</span><span class="delimiter">]</span> <span class="operator">/</span> <span class="identifier">variance</span><span class="delimiter">)</span>
                    <span class="operator">-</span> <span class="delimiter">(</span><span class="identifier">means</span><span class="delimiter">[</span><span class="identifier">k</span><span class="delimiter">]</span> <span class="operator">**</span> <span class="number">2</span> <span class="operator">/</span> <span class="delimiter">(</span><span class="number">2</span> <span class="operator">*</span> <span class="identifier">variance</span><span class="delimiter">)</span>
                    <span class="operator">+</span> <span class="identifier">log</span><span class="delimiter">(</span><span class="identifier">probabilities</span><span class="delimiter">[</span><span class="identifier">k</span><span class="delimiter">]</span><span class="delimiter">)</span>
                <span class="delimiter">)</span>
            <span class="comment"># appending discriminant values of each item to 'results' list</span>
            <span class="identifier">results</span><span class="delimiter">.</span><span class="built_in_function">append</span><span class="delimiter">(</span><span class="identifier">temp</span><span class="delimiter">)</span>

    <span class="keyword">return</span> <span class="delimiter">[</span><span class="identifier">result</span><span class="delimiter">.</span><span class="identifier">index</span><span class="delimiter">(</span><span class="built_in_function">max</span><span class="delimiter">(</span><span class="identifier">result</span><span class="delimiter">)</span> <span class="keyword">for</span> <span class="identifier">result</span> <span class="keyword">in</span> <span class="identifier">results</span><span class="delimiter">]</span>


<span class="comment"># Calculating Accuracy</span>
<span class="keyword">def</span> <span class="identifier">accuracy</span><span class="delimiter">(</span><span class="identifier">actual_y</span><span class="delimiter">:</span> <span class="built_in_function">list</span><span class="delimiter">,</span> <span class="identifier">predicted_y</span><span class="delimiter">:</span> <span class="built_in_function">list</span><span class="delimiter">)</span> <span class="operator">-</span><span class="operator">></span> <span class="built_in_function">float</span><span class="delimiter">:</span>
    <span class="comment"># iterate over one element of each list at a time (zip mode)</span>
    <span class="comment"># prediction is correct if actual Y value equals to predicted Y value</span>
    <span class="identifier">correct</span> <span class="delimiter">=</span> <span class="built_in_function">sum</span><span class="delimiter">(</span><span class="number">1</span> <span class="keyword">for</span> <span class="identifier">i</span><span class="delimiter">,</span> <span class="identifier">j</span> <span class="keyword">in</span> <span class="built_in_function">zip</span><span class="delimiter">(</span><span class="identifier">actual_y</span><span class="delimiter">,</span> <span class="identifier">predicted_y</span><span class="delimiter">)</span> <span class="keyword">if</span> <span class="identifier">i</span> <span class="delimiter">=</span> <span class="identifier">j</span><span class="delimiter">)</span>
    <span class="comment"># percentage of accuracy equals to number of correct predictions divided by number</span>
    <span class="comment"># of all data and multiplied by 100</span>
    <span class="keyword">return</span> <span class="delimiter">(</span><span class="identifier">correct</span> <span class="operator">/</span> <span class="built_in_function">len</span><span class="delimiter">(</span><span class="identifier">actual_y</span><span class="delimiter">)</span> <span class="operator">*</span> <span class="number">100</span>


<span class="identifier">num</span> <span class="delimiter">=</span> <span class="identifier">TypeVar</span><span class="delimiter">(</span><span class="string">"num"</span><span class="delimiter">)</span>


<span class="keyword">def</span> <span class="identifier">valid_input</span><span class="delimiter">(</span>
    <span class="identifier">input_type</span><span class="delimiter">:</span> <span class="identifier">Callable</span><span class="delimiter">[</span><span class="built_in_function">object</span><span class="delimiter">]</span><span class="delimiter">,</span> <span class="identifier">num</span><span class="delimiter">]</span><span class="delimiter">,</span>  <span class="comment"># Usually float or int</span>
    <span class="identifier">input_msg</span><span class="delimiter">:</span> <span class="built_in_function">str</span><span class="delimiter">,</span>
    <span class="identifier">err_msg</span><span class="delimiter">:</span> <span class="built_in_function">str</span><span class="delimiter">,</span>
    <span class="identifier">condition</span><span class="delimiter">:</span> <span class="identifier">Callable</span><span class="delimiter">[</span><span class="identifier">num</span><span class="delimiter">]</span><span class="delimiter">,</span> <span class="built_in_function">bool</span><span class="delimiter">]</span> <span class="delimiter">=</span> <span class="keyword">lambda</span> <span class="identifier">x</span><span class="delimiter">:</span> <span class="keyword">True</span><span class="delimiter">,</span>
    <span class="identifier">default</span><span class="delimiter">:</span> <span class="built_in_function">str</span> <span class="operator">|</span> <span class="keyword">None</span> <span class="delimiter">=</span> <span class="keyword">None</span><span class="delimiter">,</span>
<span class="delimiter">)</span> <span class="operator">-</span><span class="operator">></span> <span class="identifier">num</span><span class="delimiter">:</span>
    <span class="keyword">while</span> <span class="keyword">True</span><span class="delimiter">:</span>
        <span class="keyword">try</span><span class="delimiter">:</span>
            <span class="identifier">user_input</span> <span class="delimiter">=</span> <span class="identifier">input_type</span><span class="delimiter">(</span><span class="built_in_function">input</span><span class="delimiter">(</span><span class="identifier">input_msg</span><span class="delimiter">)</span><span class="delimiter">.</span><span class="identifier">strip</span><span class="delimiter">(</span><span class="delimiter">)</span> <span class="keyword">or</span> <span class="identifier">default</span><span class="delimiter">)</span>
            <span class="keyword">if</span> <span class="identifier">condition</span><span class="delimiter">(</span><span class="identifier">user_input</span><span class="delimiter">)</span><span class="delimiter">:</span>
                <span class="keyword">return</span> <span class="identifier">user_input</span>
            <span class="keyword">else</span><span class="delimiter">:</span>
                <span class="keyword">print</span><span class="delimiter">(</span><span class="identifier">f</span><span class="string">"{user_input}: {err_msg}"</span><span class="delimiter">)</span>
                <span class="keyword">continue</span>
        <span class="keyword">except</span> <span class="identifier">ValueError</span><span class="delimiter">:</span>
            <span class="keyword">print</span><span class="delimiter">(</span>
                <span class="identifier">f</span><span class="string">"{user_input}: Incorrect input type, expected {input_type.__name__!r}"</span>
            <span class="delimiter">)</span>


<span class="comment"># Main Function</span>
<span class="keyword">def</span> <span class="identifier">main</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">:</span>
    <span class="string">"""This function starts execution phase"""</span>
    <span class="keyword">while</span> <span class="keyword">True</span><span class="delimiter">:</span>
        <span class="keyword">print</span><span class="delimiter">(</span><span class="string">" Linear Discriminant Analysis ".center(50, "*"</span><span class="delimiter">)</span>
        <span class="keyword">print</span><span class="delimiter">(</span><span class="string">"*" * 50, "\n"</span><span class="delimiter">)</span>
        <span class="keyword">print</span><span class="delimiter">(</span><span class="string">"First of all we should specify the number of classes that"</span><span class="delimiter">)</span>
        <span class="keyword">print</span><span class="delimiter">(</span><span class="string">"we want to generate as training dataset"</span><span class="delimiter">)</span>
        <span class="comment"># Trying to get number of classes</span>
        <span class="identifier">n_classes</span> <span class="delimiter">=</span> <span class="identifier">valid_input</span><span class="delimiter">(</span>
            <span class="identifier">input_type</span><span class="delimiter">=</span><span class="built_in_function">int</span><span class="delimiter">,</span>
            <span class="identifier">condition</span><span class="delimiter">=</span><span class="keyword">lambda</span> <span class="identifier">x</span><span class="delimiter">:</span> <span class="identifier">x</span> <span class="operator">></span> <span class="number">0</span><span class="delimiter">,</span>
            <span class="identifier">input_msg</span><span class="delimiter">=</span><span class="string">"Enter the number of classes (Data Groupings): "</span><span class="delimiter">,</span>
            <span class="identifier">err_msg</span><span class="delimiter">=</span><span class="string">"Number of classes should be positive!"</span><span class="delimiter">,</span>
        <span class="delimiter">)</span>

        <span class="keyword">print</span><span class="delimiter">(</span><span class="string">"-"</span> <span class="operator">*</span> <span class="number">100</span><span class="delimiter">)</span>

        <span class="comment"># Trying to get the value of standard deviation</span>
        <span class="identifier">std_dev</span> <span class="delimiter">=</span> <span class="identifier">valid_input</span><span class="delimiter">(</span>
            <span class="identifier">input_type</span><span class="delimiter">=</span><span class="built_in_function">float</span><span class="delimiter">,</span>
            <span class="identifier">condition</span><span class="delimiter">=</span><span class="keyword">lambda</span> <span class="identifier">x</span><span class="delimiter">:</span> <span class="identifier">x</span> <span class="operator">></span><span class="delimiter">=</span> <span class="number">0</span><span class="delimiter">,</span>
            <span class="identifier">input_msg</span><span class="delimiter">=</span><span class="delimiter">(</span>
                <span class="string">"Enter the value of standard deviation"</span>
                <span class="string">"(Default value is 1.0 for all classes): "</span>
            <span class="delimiter">)</span><span class="delimiter">,</span>
            <span class="identifier">err_msg</span><span class="delimiter">=</span><span class="string">"Standard deviation should not be negative!"</span><span class="delimiter">,</span>
            <span class="identifier">default</span><span class="delimiter">=</span><span class="string">"1.0"</span><span class="delimiter">,</span>
        <span class="delimiter">)</span>

        <span class="keyword">print</span><span class="delimiter">(</span><span class="string">"-"</span> <span class="operator">*</span> <span class="number">100</span><span class="delimiter">)</span>

        <span class="comment"># Trying to get number of instances in classes and theirs means to generate</span>
        <span class="comment"># dataset</span>
        <span class="identifier">counts</span> <span class="delimiter">=</span> <span class="delimiter">[</span><span class="delimiter">]</span>  <span class="comment"># An empty list to store instance counts of classes in dataset</span>
        <span class="keyword">for</span> <span class="identifier">i</span> <span class="keyword">in</span> <span class="built_in_function">range</span><span class="delimiter">(</span><span class="identifier">n_classes</span><span class="delimiter">)</span><span class="delimiter">:</span>
            <span class="identifier">user_count</span> <span class="delimiter">=</span> <span class="identifier">valid_input</span><span class="delimiter">(</span>
                <span class="identifier">input_type</span><span class="delimiter">=</span><span class="built_in_function">int</span><span class="delimiter">,</span>
                <span class="identifier">condition</span><span class="delimiter">=</span><span class="keyword">lambda</span> <span class="identifier">x</span><span class="delimiter">:</span> <span class="identifier">x</span> <span class="operator">></span> <span class="number">0</span><span class="delimiter">,</span>
                <span class="identifier">input_msg</span><span class="delimiter">=</span><span class="delimiter">(</span><span class="identifier">f</span><span class="string">"Enter The number of instances for class_{i+1}: "</span><span class="delimiter">)</span><span class="delimiter">,</span>
                <span class="identifier">err_msg</span><span class="delimiter">=</span><span class="string">"Number of instances should be positive!"</span><span class="delimiter">,</span>
            <span class="delimiter">)</span>
            <span class="identifier">counts</span><span class="delimiter">.</span><span class="built_in_function">append</span><span class="delimiter">(</span><span class="identifier">user_count</span><span class="delimiter">)</span>
        <span class="keyword">print</span><span class="delimiter">(</span><span class="string">"-"</span> <span class="operator">*</span> <span class="number">100</span><span class="delimiter">)</span>

        <span class="comment"># An empty list to store values of user-entered means of classes</span>
        <span class="identifier">user_means</span> <span class="delimiter">=</span> <span class="delimiter">[</span><span class="delimiter">]</span>
        <span class="keyword">for</span> <span class="identifier">a</span> <span class="keyword">in</span> <span class="built_in_function">range</span><span class="delimiter">(</span><span class="identifier">n_classes</span><span class="delimiter">)</span><span class="delimiter">:</span>
            <span class="identifier">user_mean</span> <span class="delimiter">=</span> <span class="identifier">valid_input</span><span class="delimiter">(</span>
                <span class="identifier">input_type</span><span class="delimiter">=</span><span class="built_in_function">float</span><span class="delimiter">,</span>
                <span class="identifier">input_msg</span><span class="delimiter">=</span><span class="delimiter">(</span><span class="identifier">f</span><span class="string">"Enter the value of mean for class_{a+1}: "</span><span class="delimiter">)</span><span class="delimiter">,</span>
                <span class="identifier">err_msg</span><span class="delimiter">=</span><span class="string">"This is an invalid value."</span><span class="delimiter">,</span>
            <span class="delimiter">)</span>
            <span class="identifier">user_means</span><span class="delimiter">.</span><span class="built_in_function">append</span><span class="delimiter">(</span><span class="identifier">user_mean</span><span class="delimiter">)</span>
        <span class="keyword">print</span><span class="delimiter">(</span><span class="string">"-"</span> <span class="operator">*</span> <span class="number">100</span><span class="delimiter">)</span>

        <span class="keyword">print</span><span class="delimiter">(</span><span class="string">"Standard deviation: "</span><span class="delimiter">,</span> <span class="identifier">std_dev</span><span class="delimiter">)</span>
        <span class="comment"># print out the number of instances in classes in separated line</span>
        <span class="keyword">for</span> <span class="identifier">i</span><span class="delimiter">,</span> <span class="identifier">count</span> <span class="keyword">in</span> <span class="built_in_function">enumerate</span><span class="delimiter">(</span><span class="identifier">counts</span><span class="delimiter">,</span> <span class="number">1</span><span class="delimiter">)</span><span class="delimiter">:</span>
            <span class="keyword">print</span><span class="delimiter">(</span><span class="identifier">f</span><span class="string">"Number of instances in class_{i} is: {count}"</span><span class="delimiter">)</span>
        <span class="keyword">print</span><span class="delimiter">(</span><span class="string">"-"</span> <span class="operator">*</span> <span class="number">100</span><span class="delimiter">)</span>

        <span class="comment"># print out mean values of classes separated line</span>
        <span class="keyword">for</span> <span class="identifier">i</span><span class="delimiter">,</span> <span class="identifier">user_mean</span> <span class="keyword">in</span> <span class="built_in_function">enumerate</span><span class="delimiter">(</span><span class="identifier">user_means</span><span class="delimiter">,</span> <span class="number">1</span><span class="delimiter">)</span><span class="delimiter">:</span>
            <span class="keyword">print</span><span class="delimiter">(</span><span class="identifier">f</span><span class="string">"Mean of class_{i} is: {user_mean}"</span><span class="delimiter">)</span>
        <span class="keyword">print</span><span class="delimiter">(</span><span class="string">"-"</span> <span class="operator">*</span> <span class="number">100</span><span class="delimiter">)</span>

        <span class="comment"># Generating training dataset drawn from gaussian distribution</span>
        <span class="identifier">x</span> <span class="delimiter">=</span> <span class="delimiter">[</span>
            <span class="identifier">gaussian_distribution</span><span class="delimiter">(</span><span class="identifier">user_means</span><span class="delimiter">[</span><span class="identifier">j</span><span class="delimiter">]</span><span class="delimiter">,</span> <span class="identifier">std_dev</span><span class="delimiter">,</span> <span class="identifier">counts</span><span class="delimiter">[</span><span class="identifier">j</span><span class="delimiter">]</span><span class="delimiter">)</span>
            <span class="keyword">for</span> <span class="identifier">j</span> <span class="keyword">in</span> <span class="built_in_function">range</span><span class="delimiter">(</span><span class="identifier">n_classes</span><span class="delimiter">)</span>
        <span class="delimiter">]</span>
        <span class="keyword">print</span><span class="delimiter">(</span><span class="string">"Generated Normal Distribution: \n"</span><span class="delimiter">,</span> <span class="identifier">x</span><span class="delimiter">)</span>
        <span class="keyword">print</span><span class="delimiter">(</span><span class="string">"-"</span> <span class="operator">*</span> <span class="number">100</span><span class="delimiter">)</span>

        <span class="comment"># Generating Ys to detecting corresponding classes</span>
        <span class="identifier">y</span> <span class="delimiter">=</span> <span class="identifier">y_generator</span><span class="delimiter">(</span><span class="identifier">n_classes</span><span class="delimiter">,</span> <span class="identifier">counts</span><span class="delimiter">)</span>
        <span class="keyword">print</span><span class="delimiter">(</span><span class="string">"Generated Corresponding Ys: \n"</span><span class="delimiter">,</span> <span class="identifier">y</span><span class="delimiter">)</span>
        <span class="keyword">print</span><span class="delimiter">(</span><span class="string">"-"</span> <span class="operator">*</span> <span class="number">100</span><span class="delimiter">)</span>

        <span class="comment"># Calculating the value of actual mean for each class</span>
        <span class="identifier">actual_means</span> <span class="delimiter">=</span> <span class="delimiter">[</span><span class="identifier">calculate_mean</span><span class="delimiter">(</span><span class="identifier">counts</span><span class="delimiter">[</span><span class="identifier">k</span><span class="delimiter">]</span><span class="delimiter">,</span> <span class="identifier">x</span><span class="delimiter">[</span><span class="identifier">k</span><span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">for</span> <span class="identifier">k</span> <span class="keyword">in</span> <span class="built_in_function">range</span><span class="delimiter">(</span><span class="identifier">n_classes</span><span class="delimiter">)</span><span class="delimiter">]</span>
        <span class="comment"># for loop iterates over number of elements in 'actual_means' list and print</span>
        <span class="comment"># out them in separated line</span>
        <span class="keyword">for</span> <span class="identifier">i</span><span class="delimiter">,</span> <span class="identifier">actual_mean</span> <span class="keyword">in</span> <span class="built_in_function">enumerate</span><span class="delimiter">(</span><span class="identifier">actual_means</span><span class="delimiter">,</span> <span class="number">1</span><span class="delimiter">)</span><span class="delimiter">:</span>
            <span class="keyword">print</span><span class="delimiter">(</span><span class="identifier">f</span><span class="string">"Actual(Real) mean of class_{i} is: {actual_mean}"</span><span class="delimiter">)</span>
        <span class="keyword">print</span><span class="delimiter">(</span><span class="string">"-"</span> <span class="operator">*</span> <span class="number">100</span><span class="delimiter">)</span>

        <span class="comment"># Calculating the value of probabilities for each class</span>
        <span class="identifier">probabilities</span> <span class="delimiter">=</span> <span class="delimiter">[</span>
            <span class="identifier">calculate_probabilities</span><span class="delimiter">(</span><span class="identifier">counts</span><span class="delimiter">[</span><span class="identifier">i</span><span class="delimiter">]</span><span class="delimiter">,</span> <span class="built_in_function">sum</span><span class="delimiter">(</span><span class="identifier">counts</span><span class="delimiter">)</span> <span class="keyword">for</span> <span class="identifier">i</span> <span class="keyword">in</span> <span class="built_in_function">range</span><span class="delimiter">(</span><span class="identifier">n_classes</span><span class="delimiter">)</span>
        <span class="delimiter">]</span>

        <span class="comment"># for loop iterates over number of elements in 'probabilities' list and print</span>
        <span class="comment"># out them in separated line</span>
        <span class="keyword">for</span> <span class="identifier">i</span><span class="delimiter">,</span> <span class="identifier">probability</span> <span class="keyword">in</span> <span class="built_in_function">enumerate</span><span class="delimiter">(</span><span class="identifier">probabilities</span><span class="delimiter">,</span> <span class="number">1</span><span class="delimiter">)</span><span class="delimiter">:</span>
            <span class="keyword">print</span><span class="delimiter">(</span><span class="identifier">f</span><span class="string">"Probability of class_{i} is: {probability}"</span><span class="delimiter">)</span>
        <span class="keyword">print</span><span class="delimiter">(</span><span class="string">"-"</span> <span class="operator">*</span> <span class="number">100</span><span class="delimiter">)</span>

        <span class="comment"># Calculating the values of variance for each class</span>
        <span class="identifier">variance</span> <span class="delimiter">=</span> <span class="identifier">calculate_variance</span><span class="delimiter">(</span><span class="identifier">x</span><span class="delimiter">,</span> <span class="identifier">actual_means</span><span class="delimiter">,</span> <span class="built_in_function">sum</span><span class="delimiter">(</span><span class="identifier">counts</span><span class="delimiter">)</span>
        <span class="keyword">print</span><span class="delimiter">(</span><span class="string">"Variance: "</span><span class="delimiter">,</span> <span class="identifier">variance</span><span class="delimiter">)</span>
        <span class="keyword">print</span><span class="delimiter">(</span><span class="string">"-"</span> <span class="operator">*</span> <span class="number">100</span><span class="delimiter">)</span>

        <span class="comment"># Predicting Y values</span>
        <span class="comment"># storing predicted Y values in 'pre_indexes' variable</span>
        <span class="identifier">pre_indexes</span> <span class="delimiter">=</span> <span class="identifier">predict_y_values</span><span class="delimiter">(</span><span class="identifier">x</span><span class="delimiter">,</span> <span class="identifier">actual_means</span><span class="delimiter">,</span> <span class="identifier">variance</span><span class="delimiter">,</span> <span class="identifier">probabilities</span><span class="delimiter">)</span>
        <span class="keyword">print</span><span class="delimiter">(</span><span class="string">"-"</span> <span class="operator">*</span> <span class="number">100</span><span class="delimiter">)</span>

        <span class="comment"># Calculating Accuracy of the model</span>
        <span class="keyword">print</span><span class="delimiter">(</span><span class="identifier">f</span><span class="string">"Accuracy: {accuracy(y, pre_indexes)}"</span><span class="delimiter">)</span>
        <span class="keyword">print</span><span class="delimiter">(</span><span class="string">"-"</span> <span class="operator">*</span> <span class="number">100</span><span class="delimiter">)</span>
        <span class="keyword">print</span><span class="delimiter">(</span><span class="string">" DONE ".center(100, "+"</span><span class="delimiter">)</span>

        <span class="keyword">if</span> <span class="built_in_function">input</span><span class="delimiter">(</span><span class="string">"Press any key to restart or 'q' for quit: ").strip().lower() == "q"</span><span class="delimiter">:</span>
            <span class="keyword">print</span><span class="delimiter">(</span><span class="string">"\n" + "GoodBye!".center(100, "-") + "\n"</span><span class="delimiter">)</span>
            <span class="keyword">break</span>
        <span class="identifier">system</span><span class="delimiter">(</span><span class="string">"cls" if name == "nt" else "clear"</span><span class="delimiter">)</span>  <span class="comment"># noqa: S605</span>


<span class="keyword">if</span> <span class="identifier">__name__</span> <span class="delimiter">=</span> <span class="string">"__main__"</span><span class="delimiter">:</span>
    <span class="identifier">main</span><span class="delimiter">(</span><span class="delimiter">)</span>
            </code>
          </pre>
        </body>
      </html>